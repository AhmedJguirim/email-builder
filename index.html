<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MailBuilder - Visual Email Builder</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%233b82f6'%3E%3Cpath d='M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z'/%3E%3C/svg%3E">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html, body {
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
    }
    
    #app {
      height: 100%;
    }
    
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      background: #f5f5f5;
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid #e5e7eb;
      border-top-color: #3b82f6;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="loading">
      <div class="loading-spinner"></div>
    </div>
  </div>
  
  <script type="module">
    import { createMailBuilder } from './src/index.ts';
    
    // Sample initial blocks for demo
    const initialBlocks = [
      {
        id: 'header_1',
        type: 'header',
        preheaderText: '',
        showWebVersion: true,
        webVersionText: 'View in browser',
        styles: {
          paddingTop: '10px',
          paddingBottom: '10px',
          paddingLeft: '20px',
          paddingRight: '20px',
          fontSize: '12px',
          color: '#6b7280',
          textAlign: 'center',
        }
      },
      {
        id: 'logo_1',
        type: 'logo',
        src: '',
        alt: 'Company Logo',
        width: '150px',
        alignment: 'center',
        styles: {
          paddingTop: '30px',
          paddingBottom: '20px',
          paddingLeft: '20px',
          paddingRight: '20px',
        }
      },
      {
        id: 'heading_1',
        type: 'heading',
        content: 'Welcome to Our Newsletter',
        level: 1,
        styles: {
          paddingTop: '20px',
          paddingBottom: '10px',
          paddingLeft: '20px',
          paddingRight: '20px',
          fontSize: '28px',
          fontWeight: '700',
          color: '#111827',
          textAlign: 'center',
        }
      },
      {
        id: 'text_1',
        type: 'text',
        content: '<p>Hi {{ first_name }},</p><p>Thank you for subscribing to our newsletter. We\'re excited to have you on board!</p>',
        styles: {
          paddingTop: '10px',
          paddingBottom: '20px',
          paddingLeft: '20px',
          paddingRight: '20px',
          fontSize: '16px',
          lineHeight: '1.6',
          color: '#4b5563',
        }
      },
      {
        id: 'button_1',
        type: 'button',
        text: 'Get Started',
        link: '#',
        buttonStyles: {
          backgroundColor: '#3b82f6',
          textColor: '#ffffff',
          borderRadius: '6px',
          paddingX: '32px',
          paddingY: '14px',
          fontSize: '16px',
          fontWeight: '600',
          borderWidth: '0',
          borderColor: 'transparent',
          fullWidth: false,
        },
        styles: {
          paddingTop: '10px',
          paddingBottom: '30px',
          paddingLeft: '20px',
          paddingRight: '20px',
          textAlign: 'center',
        }
      },
      {
        id: 'divider_1',
        type: 'divider',
        dividerStyles: {
          style: 'solid',
          color: '#e5e7eb',
          thickness: '1px',
          width: '100%',
        },
        styles: {
          paddingTop: '10px',
          paddingBottom: '10px',
          paddingLeft: '20px',
          paddingRight: '20px',
        }
      },
      {
        id: 'social_1',
        type: 'social',
        links: [
          { id: 'fb_1', platform: 'facebook', url: '#' },
          { id: 'tw_1', platform: 'twitter', url: '#' },
          { id: 'ig_1', platform: 'instagram', url: '#' },
          { id: 'li_1', platform: 'linkedin', url: '#' },
        ],
        iconSize: '24px',
        iconStyle: 'color',
        spacing: '12px',
        alignment: 'center',
        styles: {
          paddingTop: '20px',
          paddingBottom: '20px',
          paddingLeft: '20px',
          paddingRight: '20px',
        }
      },
      {
        id: 'footer_1',
        type: 'footer',
        content: 'Â© {{ current_year }} {{ company_name }}. All rights reserved.',
        showUnsubscribe: true,
        showAddress: true,
        address: '{{ company_address }}',
        styles: {
          paddingTop: '20px',
          paddingBottom: '30px',
          paddingLeft: '20px',
          paddingRight: '20px',
          fontSize: '12px',
          color: '#9ca3af',
          textAlign: 'center',
          backgroundColor: '#f9fafb',
        }
      }
    ];

    // Initialize the email builder
    const builder = createMailBuilder({
      container: '#app',
      initialBlocks: initialBlocks,
      initialStyles: {
        body: {
          backgroundColor: '#f4f4f4',
          fontFamily: 'Arial, Helvetica, sans-serif',
          fontSize: '16px',
          lineHeight: '1.5',
          color: '#333333',
        },
        container: {
          backgroundColor: '#ffffff',
          maxWidth: '600px',
          borderRadius: '0',
          padding: '0',
        },
        link: {
          color: '#3b82f6',
          textDecoration: 'underline',
        },
      },
      variables: [
        { id: 'var_1', name: 'First Name', key: 'first_name', defaultValue: 'Subscriber' },
        { id: 'var_2', name: 'Last Name', key: 'last_name', defaultValue: '' },
        { id: 'var_3', name: 'Email', key: 'email', defaultValue: '' },
        { id: 'var_4', name: 'Company Name', key: 'company_name', defaultValue: 'Your Company' },
        { id: 'var_5', name: 'Company Address', key: 'company_address', defaultValue: '123 Main St, City, Country' },
        { id: 'var_6', name: 'Unsubscribe Link', key: 'unsubscribe_link', defaultValue: '#unsubscribe' },
        { id: 'var_7', name: 'View in Browser', key: 'view_in_browser_link', defaultValue: '#' },
        { id: 'var_8', name: 'Current Year', key: 'current_year', defaultValue: new Date().getFullYear().toString() },
      ],
      autosave: false,
      onBlockSelect: (block) => {
        console.log('Selected block:', block);
      },
      onBlockChange: (blocks) => {
        console.log('Blocks updated:', blocks.length, 'blocks');
      },
      onSave: (data) => {
        console.log('Email saved:', data);
        localStorage.setItem('mailbuilder_draft', JSON.stringify(data));
      },
    });

    // Expose builder to window for debugging
    window.mailBuilder = builder;
    
    console.log('MailBuilder initialized successfully!');
    console.log('Access the builder instance via window.mailBuilder');
  </script>
</body>
</html>
